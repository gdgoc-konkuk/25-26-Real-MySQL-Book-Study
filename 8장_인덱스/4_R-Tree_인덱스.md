## 3. R-Tree 인덱스
MySQL 서버의 옵티마이저가 실행 계획을 수립할 때 통계 정보와 옵티마이저 옵션을 결합해서 최적의 실행 계획을 수립한다. 
옵티마이저 옵션은 크게 조인 관련된 옵티마이저 옵션과 옵티마이저 스위치로 구분할 수 있다.

### 3.1. 옵티마이저 스위치 옵션
optimizer_switch 시스템 변수를 이용해 여러 최적화 옵션들을 on/off할 수 있다.
![alt text](./img/image3_0.png)



### 3.2. 조인 최적화 알고리즘
MySQL에는 조인 쿼리의 실행 계획 최적화를 위한 알고리즘이 2개 있다.

예시 쿼리
![alt text](./img/image3_8.png)
	- Exhaustive 검색 알고리즘
	![alt text](./img/image3_9.png)
	MySQL 5.0과 그 이전 버전에서 사용되던 조인 최적화 기법으로, From 절에 명시된 모든 테이블의 조합에 대해 실행 계획의 비용을 계산해서 최적의 조합 1개를 찾는 방법이다. n개의 테이블이 있는 경우 가능한 조인 조합이 n!개가 되므로 n이 커질수록 시간이 크게 증가한다.

	- Greedy 검색 알고리즘
	![alt text](./img/image3_10.png)
	Greedy하게 조인 순서를 결정하는 방식이다. optimizer_search_depth 시스템 변수에 설정된 값에 따라 최적화의 비용이 달라진다.

	- optimizer_search_depth 시스템 변수 : Greedy 검색 알고리즘과 Exhaustive 검색 알고리즘 중 어떤 것을 사용할지 결정하는 시스템 변수이다. 0~62까지의 정숫값을 설정할 수 있는데, 1~62까지의 값을 설정하면 그 개수만큼은 Exhaustive 알고리즘을 사용하고 이후에는 Greedy 방식을 사용한다. 0으로 설정하면 최적의 값을 옵티마이저가 자동으로 결정한다. 일반적으로 이 값을 4~5 정도로 설정하는 것이 좋다고 한다.

	- optimizer_prune_level 시스템 변수 : Heuristic 검색의 작동 여부를 0 또는 1로 지정할 수 있다. 
	* Heuristic 검색의 가장 핵심적인 내용은 다양한 조인 순서의 비용을 계산하는 도중 이미 계산했던 조인 순서의 비용보다 큰 경우에는 언제든지 중간에 포기할 수 있다는 것이다. 이외에도 아우터 조인으로 연결되는 테이블을 우선순위에서 제거하는 등 경험 기반의 최적화도 포함된다.